<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login - MacMarket</title>
    <style>
        body { margin:0; font-family: Arial, Helvetica, sans-serif; }
        #sidebar { position:fixed; left:0; top:0; bottom:0; width:180px; background:#222; color:#fff; padding-top:60px; }
        #sidebar a { color:#fff; display:block; padding:10px; text-decoration:none; }
        #sidebar a:hover { background:#444; }
        main { margin-left:180px; padding:20px; }
        label { display:block; margin:10px 0 5px; }
    </style>
</head>
<body>
<div id="sidebar">
    <a href="index.html">Home</a>
    <a href="login.html">Login</a>
    <a href="account.html">Account</a>
    <a href="tickers.html">Tickers</a>
</div>
<main>
    <h2>Login</h2>
    <form id="login-form">
        <label>Username<input type="text" id="username"></label>
        <label>Password<input type="password" id="password"></label>
        <button type="submit">Login</button>
    </form>
</main>
<script>
    document.getElementById('login-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        const resp = await fetch('/api/login', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({username, password})});
        if(resp.ok){
            const data = await resp.json();
            localStorage.setItem('userId', data.user_id);
            localStorage.setItem('username', data.username);
            localStorage.setItem('isAdmin', data.is_admin ? '1' : '0');
            window.location.href = 'account.html';
        } else {
            alert('Login failed');
        }
    });
</script>
</body>
</html>
