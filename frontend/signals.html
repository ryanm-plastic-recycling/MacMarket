<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Signals - MacMarket</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/indicators.css">
    <script src="/theme.js" defer></script>
    <script src="/ticker.js" defer></script>
    <!-- Lightweight Charts and HACO scripts loaded at end of body -->
</head>
<body>
<div id="sidebar">
    <a href="index.html">Home</a>
    <a href="login.html">Login</a>
    <a href="account.html">Account</a>
    <a href="tickers.html">Tickers</a>
    <a href="signals.html">Signals</a>
    <a href="alerts.html">Alerts</a>
    <a href="journal.html">Journal</a>
    <a href="backtests.html">Backtests</a>
    <a href="github.html">GitHub</a>
    <a href="help.html#signals">Help</a>
    <a href="admin.html" id="admin-link" style="display:none;">Admin</a>
    <a href="#" id="logout-link">Logout</a>
    <button id="theme-toggle">Toggle Theme</button>
</div>
<header>
    <img id="header-logo" src="images/logo-light.png" alt="Logo">
    <h1>MacMarket</h1>
    <div id="user-info"></div>
    <div id="time"></div>
    <div id="status"></div>
</header>
<main class="signals-page">
    <div id="ticker-bar"><button id="ticker-toggle">Pause</button><div id="ticker-track"></div></div>
    <h2>Signals</h2>
    
    <!-- New grid wrapper for page sections -->
    <div class="signals-grid">

      <!-- 1) TOP ROW (LEFT): Symbol Signal (now also drives single-rec below) -->
      <section class="signal-section symbol-signal">
        <h3>Symbol Signal</h3>
        <form id="symbol-form" class="row-controls" onsubmit="return false">
          <label>Symbol <input id="symbol" type="text" value="SPY"></label>
          <label>Mode
            <select id="mode-select" aria-label="Trading mode"></select>
          </label>
          <button id="get-signal" type="submit" aria-label="Run HACO">Run</button>
        </form>
        <div class="overview-grid" aria-live="polite">
          <section class="overview-readiness">
            <div id="readiness-score" class="readiness-score">--</div>
            <ul id="readiness-components" class="readiness-components"></ul>
          </section>
          <section class="overview-panels">
            <div id="panels-grid" class="panels-grid"></div>
          </section>
          <section class="overview-chart">
            <div id="signals-chart" class="chart-frame"></div>
          </section>
          <section class="overview-entries">
            <h4>Entries</h4>
            <ul id="entries-list" class="entries-list"></ul>
          </section>
          <section class="overview-exits">
            <h4>Exits</h4>
            <div id="exits-summary"></div>
          </section>
          <section class="overview-tabs">
            <h4>Advanced Tabs</h4>
            <div class="tabs-shell">
              <nav id="advanced-tabs-nav" class="tabs-nav"></nav>
              <div id="advanced-tab-content" class="tabs-content"></div>
            </div>
          </section>
          <section class="overview-mindset">
            <h4>Mindset</h4>
            <p id="mindset-tagline" class="muted"></p>
            <ul id="mindset-focus" class="mindset-focus"></ul>
          </section>
          <section class="overview-watchlist">
            <h4>Watchlist</h4>
            <ul id="watchlist-list" class="watchlist-list"></ul>
          </section>
        </div>
        <div id="signal-container">
          <div>
            <h4>News Sentiment</h4>
            <div id="news-output"></div>
            <small>Higher score indicates more positive news coverage.</small>
          </div>
          <div>
            <h4>Technical Signal</h4>
            <div id="tech-output"></div>
            <small>Based on 20/50 day moving average crossover.</small>
            <div id="tech-chart" style="height:300px;margin-top:1rem;"></div>
          </div>
        </div>
        <!-- Moved here: single-symbol recommendation table (driven by #symbol) -->
        <div class="single-rec-wrap">
          <table id="single-rec">
            <thead>
              <tr><th>Symbol</th><th>Action</th><th>Exit</th><th>Probability</th><th>Reason</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
        
      <!-- 2) Recommendations (full width) -->
      <section class="signal-section span-2">
        <h3>Recommendations to Invest</h3>
        <button id="get-recs">Get Recommendations</button>
        <table id="recs-table">
          <thead>
            <tr><th>Symbol</th><th>Action</th><th>Exit</th><th>Probability</th><th>Reason</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
        
      <!-- 3) HACO Strategy (full width, includes charts) -->
      <section class="signal-section span-2" id="haco-section">
        <h3>HACO Strategy</h3>
        <form id="haco-form" class="row" style="display:flex;gap:.5rem;align-items:center;" onsubmit="return false">
            <label>Symbol <input id="haco-symbol" value="SPY"></label>
            <label>Timeframe <input id="haco-timeframe" value="Day"></label>
            <label>Length Up <input id="haco-lenUp" value="34" type="number"></label>
            <label>Length Down <input id="haco-lenDown" value="34" type="number"></label>
            <label>Alert Lookback <input id="haco-alertLookback" value="1" type="number"></label>
            <label>Lookback <input id="haco-lookback" value="200" type="number"></label>
            <label><input type="checkbox" id="haco-toggleHa"> Show Heikin-Ashi</label>
            <button id="haco-run" type="submit">Run</button>
        </form>
        <div id="haco-chart" style="height:420px; position:relative;"></div>
        <div id="haco-toast" class="toast" style="display:none;"></div>
        <div id="haco-signal-chart" style="height:100px;"></div>
        <div id="haco-explain"></div>
      </section>

      <!-- 4) HACO Table (renamed from Scan; full width) -->
      <section class="signal-section span-2" id="haco-table">
        <h3>HACO Table</h3>
        <form id="scan-form" class="row" style="display:flex;gap:.5rem;align-items:center;" onsubmit="return false">
          <label for="scan-symbols"><strong>Symbols</strong> (comma-separated):</label>
          <input id="scan-symbols" type="text" value="SPY, GLD, AAPL, MSFT, GOOG, AMZN, TSLA, TPIC, XPON, OPEN, ONMD, WULF, TRIB, INTC, TLRY, AERT, NVDA, AMCR, TSLA, DNN, BBAI, BMNR, SNOA, AMD, RGTI, DFLI, NU" style="min-width:260px;">
          <button id="scan-run" type="button">Scan</button>
        </form>
        <div id="scan-status" class="muted" aria-live="polite" style="margin:.5rem 0;"></div>
        <table id="scan-table" class="table">
          <thead>
            <tr>
              <th>Symbol</th><th>Up</th><th>Down</th><th>State</th><th>Changed</th><th>Reason</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>

      <!-- 5) Macro Outlook (full width; last) -->
      <section class="signal-section span-2">
        <h3>Macro Outlook</h3>
        <textarea id="macro-text" rows="5" cols="60" placeholder="Paste macroeconomic summary..."></textarea>
        <br><button id="run-macro">Analyze</button>
        <div id="macro-output"></div>
        <small>LLM interpretation of the provided text.</small>
      </section>

    </div> <!-- /.signals-grid -->
</main>
    <script src="https://cdn.jsdelivr.net/npm/lightweight-charts@4.2.2/dist/lightweight-charts.standalone.production.js"></script>
    <script src="/js/signals.js?v=1"></script>
    <!-- Use frontend/js via /js mount and bust cache -->
    <script src="/js/haco-ui.js?v=15"></script>
    <script src="/js/haco-scan.js?v=18"></script>
    <script src="help.js"></script>
</body>
</html>
